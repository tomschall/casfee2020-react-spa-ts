query getMessages(
  $last_received_id: Int
  $last_received_ts: timestamptz
  $channel: String
) {
  channel(where: { name: { _eq: $channel } }) {
    messages(
      order_by: { timestamp: asc }
      where: {
        _and: {
          id: { _neq: $last_received_id }
          timestamp: { _gte: $last_received_ts }
        }
      }
    ) {
      id
      text
      timestamp
      user {
        username
      }
      channel {
        name
      }
      channel_threads {
        id
      }
    }
  }
}

query getChannels {
  channels: channel {
    name
    id
    is_private
    owner_id
  }
}

query getChannelByName($name: String!) {
  channel(where: { name: { _eq: $name } }) {
    name
    id
    is_private
    owner_id
  }
}

query getAuth0UserById($user_id: String) {
  user(where: { auth0_user_id: { _eq: $user_id } }) {
    id
    username
    auth0_user_id
    user_channels {
      channel {
        name
        id
        is_private
      }
    }
  }
}

query getCheckIfUserHasSubscribedToChannel($user_id: String!, $dm_to_user: String!) {
  channel(
    where: {
      user_channels: {
        _and: {
          user_id: { _eq: $user_id }
          channel: {
            user_channels: {
              user_id: { _eq: $dm_to_user }
              _and: { channel: { channel_type: { _eq: DIRECT_MESSAGE } } }
            }
          }
        }
      }
    }
  ) {
    id
    name
  }
}
